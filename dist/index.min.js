!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.t?define(["exports"],n):n((t=t||self).n={})}(this,function(t){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.e=i.e||!1,i.i=!0,"value"in i&&(i.r=!0),Object.defineProperty(t,i.u,i)}}function n(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}function u(t,n,e){return n in t?Object.defineProperty(t,n,{o:e,e:!0,i:!0,r:!0}):t[n]=e,t}function e(t){return function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}(t)||function(t){if(Symbol.c in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var c=new(function(){function t(){i(this,t),this.s=[]}return n(t,[{u:"push",o:function(n){this.s=[n].concat(e(this.s.filter(function(t){return n.name!==t.name})))}},{u:"delete",o:function(n){this.s=this.s.filter(function(t){return n.name!==t.name})}},{u:"has",o:function(t){return this.s.includes(t)}},{u:"order",a:function(){return this.s}}]),t}()),o={f:"data-view",h:"data-view-slot",v:"data-view-link",l:"data-view-active",d:"data-views-loading",w:"data-views-active",y:"data-deactivate-view",m:"data-transition"},s=function(t,n,e){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};Array.from(t).forEach(function(t){return t.k(n,e,i)})},a=function(t,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};t.b(new CustomEvent(n,{p:e,g:!0,P:!0}))},f=function(t){return t.j},h=function(t,n){return function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},i=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).e}))),i.forEach(function(t){u(n,t,e[t])})}return n}({},t,n)},v=function(){var n,t=new Promise(function(t){n=t});return t._=n,t},l={O:function(t,n){var e=t.x(n)||"";return new Set(e.split(" ").filter(Boolean))},A:function(t,n,e){l.M(t,n,e,!0)},B:function(t,n,e){l.M(t,n,e,!1)},V:function(t,n,e){return l.O(t,n).V(e)},M:function(t,n,e,i){var r=l.O(t,n);void 0===i&&(i=!r.V(e)),r[i?"A":"q"](e),t.C(n,Array.from(r).join(" "))}};function d(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise._(e.apply(this,t))}catch(t){return Promise.D(t)}}}function w(t,n,e){return e?n?n(t):t:(t&&t.S||(t=Promise._(t)),n?t.S(n):t)}var y=function(){function e(t,n){i(this,e),this.T=t,this.H=n}return n(e,[{u:"beforeExit",o:function(){return w()}},{u:"exit",o:d(function(t){this.T.I(o.m),f(this.T),this.T.C(o.m,"out")})},{u:"beforeEnter",o:function(){return w()}},{u:"enter",o:d(function(t,n){this.L(t),this.T.I(o.m),f(this.T),this.T.C(o.m,"in")})},{u:"updateHtml",o:function(t){a(this.T,"viewhtmlwillupdate"),this.T.R=t.R,a(this.T,"viewhtmldidupdate")}},{u:"done",o:function(){this.T.I(o.m),f(this.T)}}]),e}();var m=0,k={},b=function(){function t(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i(this,t),this.U=new Request(n.z,e),this.W=null,this.X="number"==typeof n.F?n.F:[Date.now(),m++].join("-"),(k[this.X]=this).N=fetch(this.U).S(function(t){return t.G?t:Promise.D()}).S(function(t){return"error"!==e.J?t:n.z!==t.z?Promise.D():t})}var e;return n(t,[{u:"includesView",o:(e=function(n){var t,e,i;return t=this.K,e=function(t){return Boolean(t.Q("[".concat(o.f,'="').concat(n,'"]')))},i?e?e(t):t:(t&&t.S||(t=Promise._(t)),e?t.S(e):t)},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise._(e.apply(this,t))}catch(t){return Promise.D(t)}})},{u:"equals",o:function(t){return!!t&&this.F===t.F}},{u:"id",a:function(){return this.X}},{u:"url",a:function(){return this.U.z}},{u:"doc",a:function(){return this.W||(this.W=this.N.S(function(t){return t.Y()}).S(function(t){return(new DOMParser).Z(t,"text/html")})),this.W}}],[{u:"getById",o:function(t){return k[t]}}]),t}();function p(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise._(e.apply(this,t))}catch(t){return Promise.D(t)}}}function g(t,n,e){return e?n?n(t):t:(t&&t.S||(t=Promise._(t)),n?t.S(n):t)}var P=function(){function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.$=t,this.tt=Object.assign(e.nt,n),this.et=this.it=!!this.$.R.trim(),this.rt=this.tt.ut,this.ot="[".concat(o.f,'="').concat(this.tt.name,'"]'),this.et&&c.push(this)}return n(e,[{u:"setModel",o:p(function(e,i){var r=this,n=i[r.name];if(!e||!e.ct(r.rt))return g(e.st(r.tt.name),function(t){if(t)return a(r.$,"viewwillupdate"),g(e.K,function(t){var n=t.Q(r.ot);return g(n&&Boolean(n.R.trim())?r.at(e,i):r.ft(i),function(t){a(r.$,"viewdidupdate")})});r.ht(n)});r.ht(n)})},{u:"_activate",o:p(function(t,n){var e,i,r=this,u=n[r.name],o=new r.tt.m(r.$,n);return r.rt=t,r.vt=!0,t.K.S(function(){return r.vt=!1}),e=function(){return g(t.K,function(t){var n,e=t.Q(r.ot);if(!e)throw n=r.name,new Error("View '".concat(n,"' activated, but not found in the loaded document"));return c.push(r),g(o.lt(e,t),function(){return r.it=!0,r.et=!0,a(r.$,"viewwillenter"),u.dt._(),g(o.wt(e,t),function(){a(r.$,"viewdidenter"),u.yt._(),o.mt()})})})},(i=function(){if(r.et)return g(o.kt(),function(){return a(r.$,"viewwillexit"),u.bt._(),g(o.pt(t.K),function(){a(r.$,"viewdidexit"),u.gt._()})});u.bt._(),u.gt._()}())&&i.S?i.S(e):e(i)})},{u:"_deactivate",o:p(function(t){var n=this,e=t[n.name];if(n.et){var i=new n.tt.m(n.$,t);return c.q(n),g(i.kt(),function(){return n.et=!1,a(n.$,"viewwillexit"),e.bt._(),g(i.pt(),function(){a(n.$,"viewdidexit"),e.gt._(),n.it=!1,e.dt._(),e.yt._(),i.mt(),n.rt=null})})}n.ht(e)})},{u:"_clearMilestone",o:function(t){Object.values(t).forEach(function(t){return t._()})}},{u:"active",a:function(){return this.Pt},jt:function(t){this.Pt!==t&&(this.Pt=t,this.$.C(o.l,t),f(this.$),l.M(document._t,"data-views-active",this.name,t))}},{u:"visible",jt:function(t){this.Ot!==t&&(this.Ot=t,this.$.C(o.l,t),f(this.$),l.M(document._t,"data-views-visible",this.name,t))}},{u:"loading",a:function(){return this.xt},jt:function(t){this.xt!==t&&(this.xt=t,l.M(document._t,o.d,this.name,t))}},{u:"name",a:function(){return this.tt.name}},{u:"transition",a:function(){return this.Et}},{u:"model",a:function(){return this.rt}}],[{u:"options",a:function(){return{name:null,m:y,ut:null}}}]),e}();function j(t,n,e){return e?n?n(t):t:(t&&t.S||(t=Promise._(t)),n?t.S(n):t)}function _(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise._(e.apply(this,t))}catch(t){return Promise.D(t)}}}var O="pushState"in history,x=new(function(){function e(){i(this,e)}return n(e,[{u:"init",o:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(O){this.tt=Object.assign({},e.nt,t),this.At=new WeakMap,this.Mt=[],Object.assign(o,this.tt.Bt);var n=this.tt.Vt(window.Ct.qt);this.rt=new b({z:n},this.tt.Dt),this.St=this.rt,this.Tt=!1,this.Ht=this.Ht.bind(this),this.It=this.It.bind(this),this.Lt(this.rt,!0),this.Rt(),this.Ut(document),a(window,"lipglossready")}}},{u:"isActive",o:function(t){var n=this.zt(t);return Boolean(n&&n.et)}},{u:"_bindEvents",o:function(){var n=this;document.k("viewdidenter",function(t){return n.Ut(t.Wt)}),window.k("popstate",function(t){return n.Xt(t)})}},{u:"initializeContext",o:function(t){var e=this,n="[".concat(o.f,"], [").concat(o.h,"]");Array.from(t.Ft(n)).filter(function(t){return!e.At.V(t)}).forEach(function(t){var n=e.Nt(t,e.rt);e.At.jt(t,n),e.Mt.push(n)}),s(t.Ft("[href][".concat(o.v,"]")),"click",this.Ht),s(t.Ft("[".concat(o.y,"]")),"click",this.It)}},{u:"_createView",o:function(t,n){var e=t.x(o.f)||t.x(o.h),i=this.tt.Gt[e]||y;return new P(t,{name:e,m:i,ut:n})}},{u:"_onLinkClick",o:_(function(t){t.Jt();var n=this.tt.Vt(t.Kt.qt);this.Qt(n)})},{u:"openUrl",o:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.tt.Dt,e=new b({z:t},n),i=this.rt&&this.rt.ct(e);this.Yt(e),this.Lt(e,i)}},{u:"_onDeactivateViewClick",o:function(t){t.Jt();var n=t.Kt.x(o.y);this.y(n)}},{u:"deactivateView",o:function(t){var n=this.zt(t),e=c.Zt.find(function(t){return!t.ut.ct(n.ut)});if(!e)throw new Error("Unable to deactivate view ".concat(t,", because there's no view to fall back to."));this.Yt(e.ut),this.Lt(e.ut)}},{u:"_getViewByName",o:function(n){return this.Mt.find(function(t){return t.name===n})}},{u:"_onPopState",o:function(t){if(t.$t)try{var n=b.tn(t.$t.nn);if(!n){var e={z:t.$t.z,F:t.$t.nn};n=new b(e,this.tt.Dt)}this.Yt(n)}catch(t){console.en(t),window.Ct.qt=model.z}}},{u:"_queueModel",o:function(t){this.St=t,this.Tt||this.in(t)}},{u:"_setModel",o:_(function(i){var t,n,r=this;return r.rt=i,r.Tt=!0,t=function(t,n){try{var e=t()}catch(t){return n(t)}return e&&e.S?e.S(void 0,n):e}(function(){a(window,"pagewillupdate");var e=r.rn(),n=r.Mt.map(_(function(t){var n=setTimeout(function(){return console.un(r.name,"timed out")},3e3);return j(t.on(i,e),function(){clearTimeout(n)})}));return j(i.K,function(t){return r.tt.cn(t),r.Mt=r.Mt.filter(function(t){return Boolean(document.Q((n=t.name,"\n  [".concat(o.f,"=").concat(n,"],\n  [").concat(o.h,"=").concat(n,"]\n"))));var n}),j(Promise.sn(n),function(){a(window,"pagedidupdate")})})},function(t){console.en(t),window.Ct.qt=i.z}),n=function(){r.Tt=!1,r.St!==i&&r.in(r.St)},t&&t.S?t.S(n):n(t)})},{u:"_getFreshMilestones",o:function(){return this.Mt.map(function(t){return u({},t.name,{bt:v(),gt:v(),dt:v(),yt:v()})}).reduce(h)}},{u:"_addHistoryEntry",o:function(t){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e={an:document.an,z:t.z,nn:t.F};history[n?"fn":"hn"](e,document.an,t.z),a(window,"statechange",e)}}],[{u:"options",a:function(){return{Gt:{},Vt:function(t){return t},cn:function(t){document.an=t.an},Bt:{},Dt:{vn:"same-origin",ln:"default",J:"error",dn:{wn:"XmlHttpRequest"}}}}}]),e}());t.yn=P,t.mn=b,t.kn=y,t.Bt=o,t.bn=x,Object.defineProperty(t,"pn",{o:!0})});
