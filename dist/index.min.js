!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.t?define(["exports"],n):n((t=t||self).n={})}(this,function(t){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.e=i.e||!1,i.i=!0,"value"in i&&(i.r=!0),Object.defineProperty(t,i.u,i)}}function n(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}function u(t,n,e){return n in t?Object.defineProperty(t,n,{o:e,e:!0,i:!0,r:!0}):t[n]=e,t}function e(t){return function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}(t)||function(t){if(Symbol.c in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var c=new(function(){function t(){i(this,t),this.a=[]}return n(t,[{u:"push",o:function(n){this.a=[n].concat(e(this.a.filter(function(t){return n.name!==t.name})))}},{u:"delete",o:function(n){this.a=this.a.filter(function(t){return n.name!==t.name})}},{u:"has",o:function(t){return this.a.includes(t)}},{u:"order",s:function(){return this.a}}]),t}()),o={f:"data-view",h:"data-view-slot",v:"data-view-link",l:"data-view-active",d:"data-views-loading",w:"data-views-active",y:"data-deactivate-view",k:"data-transition"},a=function(t,n,e){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};Array.from(t).forEach(function(t){return t.m(n,e,i)})},s=function(t,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=new CustomEvent(n,{p:e,b:!0,g:!0});return t.P(i),i},f=function(t){return t.j},h=function(t,n){return function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},i=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).e}))),i.forEach(function(t){u(n,t,e[t])})}return n}({},t,n)},v=function(){var n,t=new Promise(function(t){n=t});return t._=n,t},l={O:function(t,n){var e=t.x(n)||"";return new Set(e.split(" ").filter(Boolean))},A:function(t,n,e){l.M(t,n,e,!0)},B:function(t,n,e){l.M(t,n,e,!1)},V:function(t,n,e){return l.O(t,n).V(e)},M:function(t,n,e,i){var r=l.O(t,n);void 0===i&&(i=!r.V(e)),r[i?"A":"q"](e),t.C(n,Array.from(r).join(" "))}};function d(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise._(e.apply(this,t))}catch(t){return Promise.D(t)}}}function w(t,n,e){return e?n?n(t):t:(t&&t.S||(t=Promise._(t)),n?t.S(n):t)}var y=function(){function e(t,n){i(this,e),this.T=t,this.H=n}return n(e,[{u:"beforeExit",o:function(){return w()}},{u:"exit",o:d(function(t){this.T.I(o.k),f(this.T),this.T.C(o.k,"out")})},{u:"beforeEnter",o:function(){return w()}},{u:"enter",o:d(function(t,n){this.L(t),this.T.I(o.k),f(this.T),this.T.C(o.k,"in")})},{u:"updateHtml",o:function(t){s(this.T,"viewhtmlwillupdate"),this.T.R=t.R,s(this.T,"viewhtmldidupdate")}},{u:"done",o:function(){this.T.I(o.k),f(this.T)}}]),e}();var k=0,m={},p=function(){function t(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i(this,t),this.U=new Request(n.z,e),this.F=null,this.W="number"==typeof n.X?n.X:[Date.now(),k++].join("-"),(m[this.W]=this).N=fetch(this.U).S(function(t){return t.G?t:Promise.D()}).S(function(t){return"error"!==e.J?t:n.z!==t.z?Promise.D():t})}var e;return n(t,[{u:"includesView",o:(e=function(n){var t,e,i;return t=this.K,e=function(t){return Boolean(t.Q("[".concat(o.f,'="').concat(n,'"]')))},i?e?e(t):t:(t&&t.S||(t=Promise._(t)),e?t.S(e):t)},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise._(e.apply(this,t))}catch(t){return Promise.D(t)}})},{u:"equals",o:function(t){return!!t&&this.X===t.X}},{u:"id",s:function(){return this.W}},{u:"url",s:function(){return this.U.z}},{u:"doc",s:function(){return this.F||(this.F=this.N.S(function(t){return t.Y()}).S(function(t){return(new DOMParser).Z(t,"text/html")})),this.F}}],[{u:"getById",o:function(t){return m[t]}}]),t}();function b(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise._(e.apply(this,t))}catch(t){return Promise.D(t)}}}function g(t,n,e){return e?n?n(t):t:(t&&t.S||(t=Promise._(t)),n?t.S(n):t)}var P=function(){function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.$=t,this.tt=Object.assign(e.nt,n),this.et=this.it=!!this.$.R.trim(),this.rt=this.tt.ut,this.ot="[".concat(o.f,'="').concat(this.tt.name,'"]'),this.et&&c.push(this)}return n(e,[{u:"setModel",o:b(function(i,r){var u=this,n=r[u.name];if(!i||!i.ct(u.rt))return g(i.at(u.tt.name),function(t){if(t)return g(i.K,function(t){var n=t.Q(u.ot),e=n&&Boolean(n.R.trim());return s(u.$,"viewwillupdate"),g(e?u.st(i,r):u.ft(r),function(t){s(u.$,"viewdidupdate")})});u.ht(n)});u.ht(n)})},{u:"_activate",o:b(function(t,n){var e,i,r=this,u=n[r.name],o=new r.tt.k(r.$,n);return r.rt=t,r.vt=!0,t.K.S(function(){return r.vt=!1}),e=function(){return g(t.K,function(t){var n,e=t.Q(r.ot);if(!e)throw n=r.name,new Error("View '".concat(n,"' activated, but not found in the loaded document"));return c.push(r),g(o.lt(e,t),function(){return r.it=!0,r.et=!0,s(r.$,"viewwillenter"),u.dt._(),g(o.wt(e,t),function(){s(r.$,"viewdidenter"),u.yt._(),o.kt()})})})},(i=function(){if(r.et)return g(o.mt(),function(){return s(r.$,"viewwillexit"),u.pt._(),g(o.bt(t.K),function(){s(r.$,"viewdidexit"),u.gt._()})});u.pt._(),u.gt._()}())&&i.S?i.S(e):e(i)})},{u:"_deactivate",o:b(function(t){var n=this,e=t[n.name];if(n.et){var i=new n.tt.k(n.$,t);return c.q(n),g(i.mt(),function(){return n.et=!1,s(n.$,"viewwillexit"),e.pt._(),g(i.bt(),function(){s(n.$,"viewdidexit"),e.gt._(),n.it=!1,e.dt._(),e.yt._(),i.kt(),n.rt=null})})}n.ht(e)})},{u:"_clearMilestone",o:function(t){Object.values(t).forEach(function(t){return t._()})}},{u:"active",s:function(){return this.Pt},jt:function(t){this.Pt!==t&&(this.Pt=t,this.$.C(o.l,t),f(this.$),l.M(document._t,"data-views-active",this.name,t))}},{u:"visible",jt:function(t){this.Ot!==t&&(this.Ot=t,this.$.C(o.l,t),f(this.$),l.M(document._t,"data-views-visible",this.name,t))}},{u:"loading",s:function(){return this.xt},jt:function(t){this.xt!==t&&(this.xt=t,l.M(document._t,o.d,this.name,t))}},{u:"name",s:function(){return this.tt.name}},{u:"transition",s:function(){return this.Et}},{u:"model",s:function(){return this.rt}}],[{u:"options",s:function(){return{name:null,k:y,ut:null}}}]),e}();function j(t,n,e){return e?n?n(t):t:(t&&t.S||(t=Promise._(t)),n?t.S(n):t)}function _(){}function O(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise._(e.apply(this,t))}catch(t){return Promise.D(t)}}}var x="pushState"in history,E=new(function(){function e(){i(this,e)}return n(e,[{u:"init",o:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(x){this.tt=Object.assign({},e.nt,t),this.At=new WeakMap,this.Mt=[],Object.assign(o,this.tt.Bt);var n=this.tt.Vt(window.Ct.qt);this.rt=new p({z:n},this.tt.Dt),this.St=this.rt,this.Tt=!1,this.Ht=this.Ht.bind(this),this.It=this.It.bind(this),this.Lt(this.rt,!0),this.Rt(),this.Ut(document),s(window,"lipglossready")}}},{u:"isActive",o:function(t){var n=this.zt(t);return Boolean(n&&n.et)}},{u:"_bindEvents",o:function(){var n=this;document.m("viewdidenter",function(t){return n.Ut(t.Ft)}),window.m("popstate",function(t){return n.Wt(t)})}},{u:"initializeContext",o:function(t){var e=this,n="[".concat(o.f,"], [").concat(o.h,"]");Array.from(t.Xt(n)).filter(function(t){return!e.At.V(t)}).forEach(function(t){var n=e.Nt(t,e.rt);e.At.jt(t,n),e.Mt.push(n)}),a(t.Xt("[href][".concat(o.v,"]")),"click",this.Ht),a(t.Xt("[".concat(o.y,"]")),"click",this.It)}},{u:"_createView",o:function(t,n){var e=t.x(o.f)||t.x(o.h),i=this.tt.Gt[e]||y;return new P(t,{name:e,k:i,ut:n})}},{u:"_onLinkClick",o:O(function(t){if(t.Jt(),!s(t.Qt,"viewlinkclick").Kt){var n=this.tt.Vt(t.Qt.qt);this.Yt(n)}})},{u:"openUrl",o:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.tt.Dt,e=new p({z:t},n),i=this.rt&&this.rt.ct(e);this.Zt(e),this.Lt(e,i)}},{u:"_onDeactivateViewClick",o:function(t){if(t.Jt(),!s(t.Qt,"viewlinkclick").Kt){var n=t.Qt.x(o.y);this.y(n)}}},{u:"deactivateView",o:function(t){var n=this.zt(t),e=c.$t.find(function(t){return!t.ut.ct(n.ut)});if(!e)throw new Error("Unable to deactivate view ".concat(t,", because there's no view to fall back to."));this.Zt(e.ut),this.Lt(e.ut)}},{u:"_getViewByName",o:function(n){return this.Mt.find(function(t){return t.name===n})}},{u:"_onPopState",o:function(t){if(t.tn)try{var n=p.nn(t.tn.en);if(!n){var e={z:t.tn.z,X:t.tn.en};n=new p(e,this.tt.Dt)}this.Zt(n)}catch(t){console.in(t),window.Ct.qt=model.z}}},{u:"_queueModel",o:function(t){this.St=t,this.Tt||this.rn(t)}},{u:"_setModel",o:O(function(n){var t,e,i=this;return i.rt=n,i.Tt=!0,t=function(t,n){try{var e=t()}catch(t){return n(t)}return e&&e.S?e.S(void 0,n):e}(function(){return function(t,n){if(!n)return t&&t.S?t.S(_):Promise._()}(i.un(n))},function(t){console.in(t),window.Ct.qt=n.z}),e=function(){i.Tt=!1,i.St!==n&&i.rn(i.St)},t&&t.S?t.S(e):e(t)})},{u:"updatePage",o:O(function(e){var n=this;if(!s(window,"pagewillupdate").Kt){var i=n.on(),r=n.Mt.map(O(function(t){var n=setTimeout(function(){return console.cn(t.name,"timed out")},3e3);return j(new Promise(function(t){return requestAnimationFrame(t)}),function(){return j(t.an(e,i),function(){clearTimeout(n)})})}));return j(e.K,function(t){return s(window,"pagestartsupdate"),n.tt.sn(t),n.Mt=n.Mt.filter(function(t){return Boolean(document.Q((n=t.name,"\n  [".concat(o.f,"=").concat(n,"],\n  [").concat(o.h,"=").concat(n,"]\n"))));var n}),j(Promise.fn(r),function(){s(window,"pagedidupdate")})})}})},{u:"_getFreshMilestones",o:function(){return this.Mt.map(function(t){return u({},t.name,{pt:v(),gt:v(),dt:v(),yt:v()})}).reduce(h)}},{u:"_addHistoryEntry",o:function(t){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e={hn:document.hn,z:t.z,en:t.X};history[n?"vn":"ln"](e,document.hn,t.z),s(window,"statechange",e)}}],[{u:"options",s:function(){return{Gt:{},Vt:function(t){return t},sn:function(t){document.hn=t.hn},Bt:{},Dt:{dn:"same-origin",wn:"default",J:"error",yn:{kn:"XmlHttpRequest"}}}}}]),e}());t.mn=P,t.pn=p,t.bn=y,t.Bt=o,t.gn=E,Object.defineProperty(t,"Pn",{o:!0})});
